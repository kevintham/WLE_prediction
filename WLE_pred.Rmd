---
title: "Prediction of Human Physical Activity Execution Quality"
author: "Kevin Tham"
date: "May 18, 2018"
output:
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
if (!require("pacman"))
  install.packages("pacman", repos = "http://cran.us.r-project.org")
pacman::p_load(knitr, dplyr, ggplot2, GGally, tidyr, grid, gridExtra, car, broom, tibble)
```

```{r}
url1 <- 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv'
url2 <- 'https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv'
destfile1 <- 'pml-training.csv'
destfile2 <- 'pml-testing.csv'
  
if (!file.exists(destfile1))
  download.file(url1, destfile1, method = "auto")
if (!file.exists(destfile2))
  download.file(url2, destfile2, method = "auto")

train <- read.csv(destfile1)
test <- read.csv(destfile2)

ytrain <- train$classe
ytest <- test$classe

train <- train[,-160]
test <- test[,-160]

dim(train)
dim(test)

na_count <- sapply(train, function(y) sum(is.na(y)))
na_count

nacols <- which(na_count>100)
train <- select(train, -nacols)
test <- select(test, -nacols)

str(train)
```